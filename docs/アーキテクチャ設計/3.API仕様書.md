## 3. API仕様書

### 3-1. 認証系

| 機能              | メソッド | エンドポイント       | 入力 (Body/Query)                                 | 出力 (レスポンス)              | 備考                                 |
|-------------------|---------|----------------------|---------------------------------------------------|--------------------------------|---------------------------------------|
| ユーザー登録      | POST    | `/api/auth/register` | `{ "name", "email", "password" }`                | ユーザー情報 (id, name, email) | パスワードはハッシュ化して保存        |
| ログイン          | POST    | `/api/auth/login`    | `{ "email", "password" }`                        | `{ "access_token" }`           | JWTを返却。以降はBearer認証でアクセス|
| ログアウト        | POST    | `/api/auth/logout`   | なし                                              | なし                           | トークン失効をどう扱うかは運用次第    |

### 3-2. ユーザー系

| 機能            | メソッド | エンドポイント  | 入力 (Body/Query)       | 出力 (レスポンス)                | 備考                                                   |
|-----------------|---------|-----------------|-------------------------|----------------------------------|-------------------------------------------------------|
| ユーザー一覧取得| GET     | `/api/users`    | なし                    | `[ { "id", "name", "email" }, ... ]` | 管理者権限がある場合のみ取得可など、要件次第           |
| ユーザー詳細    | GET     | `/api/users/{id}` | なし                    | `{ "id", "name", "email" }`      | ログインユーザー自身 or 管理者のみ取得可など検討       |
| ユーザー更新    | PUT     | `/api/users/{id}` | `{ "name", "email" }`  | 更新後のユーザー情報             | 認証必須。本人 or 管理者のみ。                         |

### 3-3. イベント系

| 機能                 | メソッド | エンドポイント    | 入力 (Body/Query)                                                                     | 出力 (レスポンス)                          | 備考                                          |
|----------------------|---------|-------------------|---------------------------------------------------------------------------------------|--------------------------------------------|----------------------------------------------|
| イベント一覧取得     | GET     | `/api/events`     | `?keyword=xxx&status=planned&...` (オプションで検索)                                 | `[ { "id", "start_time", "end_time", ...}, ... ]` | 日時やキーワード等でフィルタリング            |
| イベント詳細取得     | GET     | `/api/events/{id}`| なし                                                                                  | `{ "id", "start_time", "end_time", "place", ... }` | 参加者情報は別エンドポイントor同時に返すか要検討 |
| イベント作成         | POST    | `/api/events`     | `{ "start_time", "end_time", "place", "content", "status", "total_cost" }`           | 登録したイベントの情報                      | 作成完了後、Discord Webhook通知を行うか       |
| イベント更新         | PUT     | `/api/events/{id}`| `{ "start_time", "end_time", "place", "content", "status", "total_cost" }`           | 更新後のイベント情報                        |                                              |
| イベント削除         | DELETE  | `/api/events/{id}`| なし                                                                                  | なし                                       | 参加者との関連削除をどう扱うか（物理/論理）    |

### 3-4. 参加者系

| 機能                    | メソッド | エンドポイント                                   | 入力 (Body/Query)                           | 出力 (レスポンス)                    | 備考                                                                      |
|-------------------------|---------|--------------------------------------------------|---------------------------------------------|--------------------------------------|---------------------------------------------------------------------------|
| 参加者一覧(イベント毎)  | GET     | `/api/events/{event_id}/participants`           | なし                                          | `[ { "user_id", "paid_amount", ...}, ... ]` | イベントに紐づくユーザーと支払金額のリスト                                 |
| 参加者追加              | POST    | `/api/events/{event_id}/participants`           | `{ "user_id", "paid_amount" }`              | 追加後の参加者情報                   | `user_id`が既に登録済みの場合はエラーにするなど、運用次第                  |
| 参加者情報更新          | PUT     | `/api/events/{event_id}/participants/{p_id}`    | `{ "paid_amount" }`                         | 更新後の参加者情報                   | 支払金額の更新                                                            |
| 参加者削除              | DELETE  | `/api/events/{event_id}/participants/{p_id}`    | なし                                          | なし                                 | 中間テーブルからの削除。                                                  |
